# 데이터 준비 가이드

본인의 데이터로 비모수 분석을 수행하기 위한 안내입니다.

## 1. 데이터 입력 방법

데이터를 입력하는 방법은 **2가지**입니다. 상황에 맞는 방법을 선택하세요.

### 방법 A: CSV 파일 사용 (기본)

파일을 자유롭게 저장할 수 있는 경우 이 방법을 사용합니다.

1. Excel에서 "다른 이름으로 저장" → **"CSV UTF-8"** 로 저장
2. 저장한 `.csv` 파일을 `02_Data/` 폴더에 넣기
3. 노트북 설정 셀에서 `FILE_NAME`에 파일명 입력

```python
FILE_NAME = "my_data.csv"
```

### 방법 B: 복사/붙여넣기 (DRM 문서용)

**DRM이 걸린 문서**나 파일 저장이 어려운 경우 이 방법을 사용합니다.

1. 원본 문서에서 데이터 영역을 선택하고 **복사** (Ctrl+C)
2. 노트북 설정 셀의 `PASTE_DATA` 변수에 **붙여넣기** (Ctrl+V)

```python
# 쉼표 구분 데이터:
PASTE_DATA = """
이름,매출액,지역
김철수,1520,서울
이영희,1680,부산
박민수,1450,대구
"""

# 탭 구분 데이터 (Excel에서 복사 시):
PASTE_DATA = """
이름	매출액	지역
김철수	1520	서울
이영희	1680	부산
"""
```

- 첫 번째 행은 **반드시 컬럼명**이어야 합니다
- **쉼표, 탭, 세미콜론** 구분자 모두 자동 인식됩니다
- `PASTE_DATA`에 데이터가 있으면 `FILE_NAME`은 무시됩니다

> **팁**: Excel에서 셀 범위를 선택 → 복사 → 노트북에 붙여넣기하면 탭으로 구분된 데이터가 입력됩니다.

## 2. 데이터 구조 예시

### 기본 구조 (단일 변수 분석용)

최소한 **분석할 숫자 컬럼 1개**만 있으면 됩니다.

```csv
매출액
1520
1680
1450
1790
...
```

### 그룹 비교가 필요한 경우

**그룹을 구분하는 컬럼**이 추가로 필요합니다.

```csv
지역,매출액
서울,1520
부산,1680
서울,1450
부산,1790
...
```

→ 노트북 설정:
```python
TARGET_COLUMN = "매출액"
GROUP_COLUMN  = "지역"
GROUP_A_VALUE = "서울"
GROUP_B_VALUE = "부산"
```

### 전/후 비교가 필요한 경우

**같은 대상의 전/후 측정값**이 각각 별도 컬럼에 있어야 합니다.

```csv
사원번호,교육전_점수,교육후_점수
E001,65,72
E002,70,68
E003,55,78
...
```

→ 노트북 설정:
```python
TARGET_COLUMN  = "교육전_점수"    # 단일변수 분석에도 사용됨
BEFORE_COLUMN  = "교육전_점수"
AFTER_COLUMN   = "교육후_점수"
```

### 3개 이상 그룹 비교 (Kruskal-Wallis)

그룹 컬럼에 3개 이상의 값이 있으면 됩니다.

```csv
지역,매출액
서울,1520
부산,1680
대구,1350
서울,1450
부산,1790
대구,1420
...
```

→ 노트북 설정:
```python
GROUP_COLUMN       = "지역"
MULTI_GROUP_VALUES = ["서울", "부산", "대구"]
```

### 반복 측정 비교 (Friedman)

**동일 대상**을 여러 시점에 측정한 데이터가 각각 별도 컬럼에 있어야 합니다.

```csv
환자번호,1개월,3개월,6개월
P001,72,65,58
P002,80,75,70
P003,68,62,55
...
```

→ 노트북 설정:
```python
REPEATED_COLUMNS = ["1개월", "3개월", "6개월"]
```

### 상관분석

여러 숫자 컬럼이 있으면 자동으로 상관분석이 수행됩니다.
특정 컬럼만 분석하려면 지정하세요.

```csv
매출액,광고비,방문수
1520,200,3500
1680,350,4200
...
```

→ 노트북 설정:
```python
CORRELATION_COLUMNS = ["매출액", "광고비", "방문수"]  # 비워두면 모든 숫자 컬럼 자동 사용
```

## 3. 분석 실행 단계

1. **데이터 준비**: CSV 파일을 `02_Data/`에 넣기 **또는** 데이터를 복사해두기
2. `04_Notebooks/nonparametric_analysis_template.ipynb` 열기
3. **설정 셀** 수정:
   - CSV 사용 시: `FILE_NAME`, `TARGET_COLUMN` 등 입력
   - 붙여넣기 시: `PASTE_DATA`에 데이터 붙여넣기, `TARGET_COLUMN` 등 입력
4. **전체 셀 실행** (메뉴: Run → Run All Cells)
5. 해당되지 않는 분석은 자동으로 건너뜁니다

## 4. 자주 묻는 질문

### Q: Excel 파일(.xlsx)도 사용할 수 있나요?
A: 두 가지 방법이 있습니다:
- **방법 1**: Excel에서 "다른 이름으로 저장" → "CSV UTF-8"로 저장한 후 사용
- **방법 2**: Excel에서 데이터 영역 선택 → 복사(Ctrl+C) → 노트북의 `PASTE_DATA`에 붙여넣기

### Q: DRM이 걸린 문서의 데이터는 어떻게 하나요?
A: 문서에서 데이터를 **복사**(Ctrl+C)할 수 있다면, 노트북의 `PASTE_DATA` 변수에 직접 **붙여넣기**(Ctrl+V)하면 됩니다. 파일 저장 없이 바로 분석이 가능합니다.

### Q: 컬럼명에 한글을 써도 되나요?
A: 네, 한글 컬럼명을 그대로 사용하시면 됩니다.

### Q: 빈 칸(결측치)이 있어도 되나요?
A: 네, 분석 시 자동으로 결측치를 제외합니다. 다만 너무 많으면 결과의 신뢰도가 낮아집니다.

### Q: 데이터가 몇 행 이상이어야 하나요?
A: 최소 **20행 이상**을 권장합니다. 그룹 비교 시 각 그룹당 10행 이상이 바람직합니다.

### Q: 설정을 잘못 입력하면 어떻게 되나요?
A: 데이터 검증 셀에서 **한국어 오류 메시지**가 표시됩니다. 메시지를 읽고 설정 셀을 수정한 후 다시 실행하세요.

## 5. 동봉된 샘플 데이터

`sample_nonparametric.csv`는 아래 구조의 예시 데이터입니다:

| 컬럼명 | 타입 | 설명 |
|--------|------|------|
| entity_id | 문자 | 개체 식별자 (E001~E120) |
| time_index | 숫자 | 시간 순서 (1~120) |
| group | 문자 | 그룹 구분 (control / treatment) |
| feature_1 | 숫자 | 분석 대상 변수 1 |
| feature_2 | 숫자 | 분석 대상 변수 2 |
| feature_3 | 숫자 | 분석 대상 변수 3 |
| feature_total | 숫자 | 합산 변수 |

이 샘플로 먼저 노트북을 실행해보고, 동작을 확인한 후 본인 데이터로 교체하는 것을 권장합니다.
